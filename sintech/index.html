<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logo test</title>
    <link rel="stylesheet" type="text/css" href="./css/reset.css">
    <link rel="stylesheet" type="text/css" href="./css/main.css">
    <script src="js/pixijs.js"></script>
</head>
<body>
    <script>
        // Config variable
        const ww = window.innerWidth;
        const canvasHeight = 650;

        // App canvas configuration
        let app = new PIXI.Application();
        app.renderer.view.style.position = "absolute";
        app.renderer.view.style.display = "block";
        app.renderer.autoResize = true;
        app.renderer.resize(ww, canvasHeight);
        document.body.appendChild(app.view);

        // the box title
        let title = new PIXI.Sprite.from("images/the-box-title.png");
        addToStage(title);

        // title mask
        let titleMask = new PIXI.Sprite.from("images/the-box-title-map.png");
        addToStage(titleMask);

        //box image
        let box = new PIXI.Sprite.from("images/box.png");
        addToStage(box, 190);

        // box image mask
        let boxMask = new PIXI.Sprite.from("images/box-mapv2.png");
        addToStage(boxMask, 190);

        // masks
        displacementFilter = new PIXI.filters.DisplacementFilter(titleMask);
        boxFilter = new PIXI.filters.DisplacementFilter(boxMask);
        app.stage.filters = [displacementFilter, boxFilter];

        window.onmousemove = function(e) {
            app.stage.filters.forEach(element => {
                element.scale.x = (window.innerWidth / 2 - e.clientX) /20;
                element.scale.y = (window.innerHeight / 2 - e.clientY) /20;
            });
        };

        let accelerometer = new Accelerometer({frequency: 60});

        accelerometer.addEventListener('reading', e => {
            element.scale.x = (window.innerWidth / 2 - accelerometer.x) /20;
            element.scale.y = (window.innerHeight / 2 - accelerometer.y) /20;
            console.log("Acceleration along the X-axis " + accelerometer.x);
            console.log("Acceleration along the Y-axis " + accelerometer.y);
        });
        accelerometer.start();

        function addToStage(image, adjustHeight = false){
            image.position.x = (ww - image.width) / 2;
            (adjustHeight) ? image.position.y = adjustHeight : '';
            app.stage.addChild(image);
        }

        let background = new Audio('audio/bgtest.mp3');
        document.addEventListener('click' , function(){
            background.play();
        })
    </script>

    <p class="acessar">
        Acessar
    </p>
</body>

</html>
